# Plugin usage

The `web-resource-deduplicator-maven-plugin` is a Maven plugin designed to reduce the size of the site generated by the `maven-site-plugin`. The latter, depending on the skin, may copy resources that the final site might not use. For example, the **built by Maven** image comes in two colors (white and black). It is likely that your site only needs one of them, or perhaps none at all if you do not wish to display this logo.

Furthermore, in a multi-module Maven build, each module generates its own site independently. The `site-stage` goal allows these standalone sites to be combined into a single site, but each site will contain all the resources of the skin used. If we take the example of the **built by Maven** logo, a project with one parent module and two child modules will have 6 images (2 per module). The `web-resource-deduplicator-maven-plugin` reads all the generated HTML and CSS files, creates a list of referenced resources, identifies duplicates using a checksum, and retains only one resource for each actually used resource. Resources not referenced in any HTML or CSS file will be removed.

**NOTE:** It is entirely possible to use this plugin on a website not generated by the `maven-site-plugin`. However, this is not its primary purpose, and feature requests or bug fixes related to sites other than those generated by the maven-site-plugin will not be prioritized and may even be rejected.

**NOTE 2:** Ressources only used by Javascript files will be deleted. As a workaround, you can create a fake HTML file and refefence theses files.

## Quick start

The `web-resource-deduplicator-maven-plugin` must be run after the `site:stage` goal of the `maven-site-plugin`. You cannot use the `site:stage-deploy`; this plugin should be run after the `stage` goal and before the `deploy` goal.

```shell
mvn site:site <1>
mvn site:stage <2>
mvn eu.gyfz:web-resource-deduplicator-maven-plugin:$context.get("latest.plugin.version"):deduplicate <3>
```
- <1> Build the website using the maven-site-plugin
- <2> For multi-module projects, combine the sites into a single site
- <3> Deduplicate the resources and remove unused resources.

[More information on usage page.](plugin-usage.html)

## Add the plugin to your project

See the [Maven Coordinates page](dependency-info.html)  to add the plugin to your pom.xml.

### Configuration

**NOTE:** This plugin is not bound to a maven lifecycle phase. You must call it explicitly.

Once you have added the plugin to your project, you can replace the last command (<3>) with the following :

```shell
mvn web-resource-deduplicator:deduplicate
```

See the [Deduplicate mojo page](deduplicate-mojo.html) for more information on how to configure the plugin.
